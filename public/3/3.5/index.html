<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.92.2" />
    <meta name="description" content="">
<meta name="author" content="journeyoftheaverageguy@gmail.com">

    <link rel="icon" href="/images/favicon.png" type="image/png">

    <title>Building your own Security Hub integration :: Threat Detection &amp; Response</title>

    
    <link href="/css/nucleus.css?1768930323" rel="stylesheet">
    <link href="/css/fontawesome-all.min.css?1768930323" rel="stylesheet">
    <link href="/css/hybrid.css?1768930323" rel="stylesheet">
    <link href="/css/featherlight.min.css?1768930323" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css?1768930323" rel="stylesheet">
    <link href="/css/auto-complete.css?1768930323" rel="stylesheet">
    <link href="/css/atom-one-dark-reasonable.css?1768930323" rel="stylesheet">
    <link href="/css/theme.css?1768930323" rel="stylesheet">
    <link href="/css/hugo-theme.css?1768930323" rel="stylesheet">
    
    <link href="/css/theme-workshop.css?1768930323" rel="stylesheet">
    
    

    <script src="/js/jquery-3.3.1.min.js?1768930323"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="/3/3.5/">
    <nav id="sidebar" class="showVisitedLinks">



  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href="/">

<svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 60 30" width="30%"><defs><style>.cls-1{fill:#fff;}.cls-2{fill:#f90;fill-rule:evenodd;}</style></defs><title>AWS-Logo_White-Color</title><path class="cls-1" d="M14.09,10.85a4.7,4.7,0,0,0,.19,1.48,7.73,7.73,0,0,0,.54,1.19.77.77,0,0,1,.12.38.64.64,0,0,1-.32.49l-1,.7a.83.83,0,0,1-.44.15.69.69,0,0,1-.49-.23,3.8,3.8,0,0,1-.6-.77q-.25-.42-.51-1a6.14,6.14,0,0,1-4.89,2.3,4.54,4.54,0,0,1-3.32-1.19,4.27,4.27,0,0,1-1.22-3.2A4.28,4.28,0,0,1,3.61,7.75,6.06,6.06,0,0,1,7.69,6.46a12.47,12.47,0,0,1,1.76.13q.92.13,1.91.36V5.73a3.65,3.65,0,0,0-.79-2.66A3.81,3.81,0,0,0,7.86,2.3a7.71,7.71,0,0,0-1.79.22,12.78,12.78,0,0,0-1.79.57,4.55,4.55,0,0,1-.58.22l-.26,0q-.35,0-.35-.52V2a1.09,1.09,0,0,1,.12-.58,1.2,1.2,0,0,1,.47-.35A10.88,10.88,0,0,1,5.77.32,10.19,10.19,0,0,1,8.36,0a6,6,0,0,1,4.35,1.35,5.49,5.49,0,0,1,1.38,4.09ZM7.34,13.38a5.36,5.36,0,0,0,1.72-.31A3.63,3.63,0,0,0,10.63,12,2.62,2.62,0,0,0,11.19,11a5.63,5.63,0,0,0,.16-1.44v-.7a14.35,14.35,0,0,0-1.53-.28,12.37,12.37,0,0,0-1.56-.1,3.84,3.84,0,0,0-2.47.67A2.34,2.34,0,0,0,5,11a2.35,2.35,0,0,0,.61,1.76A2.4,2.4,0,0,0,7.34,13.38Zm13.35,1.8a1,1,0,0,1-.64-.16,1.3,1.3,0,0,1-.35-.65L15.81,1.51a3,3,0,0,1-.15-.67.36.36,0,0,1,.41-.41H17.7a1,1,0,0,1,.65.16,1.4,1.4,0,0,1,.33.65l2.79,11,2.59-11A1.17,1.17,0,0,1,24.39.6a1.1,1.1,0,0,1,.67-.16H26.4a1.1,1.1,0,0,1,.67.16,1.17,1.17,0,0,1,.32.65L30,12.39,32.88,1.25A1.39,1.39,0,0,1,33.22.6a1,1,0,0,1,.65-.16h1.54a.36.36,0,0,1,.41.41,1.36,1.36,0,0,1,0,.26,3.64,3.64,0,0,1-.12.41l-4,12.86a1.3,1.3,0,0,1-.35.65,1,1,0,0,1-.64.16H29.25a1,1,0,0,1-.67-.17,1.26,1.26,0,0,1-.32-.67L25.67,3.64,23.11,14.34a1.26,1.26,0,0,1-.32.67,1,1,0,0,1-.67.17Zm21.36.44a11.28,11.28,0,0,1-2.56-.29,7.44,7.44,0,0,1-1.92-.67,1,1,0,0,1-.61-.93v-.84q0-.52.38-.52a.9.9,0,0,1,.31.06l.42.17a8.77,8.77,0,0,0,1.83.58,9.78,9.78,0,0,0,2,.2,4.48,4.48,0,0,0,2.43-.55,1.76,1.76,0,0,0,.86-1.57,1.61,1.61,0,0,0-.45-1.16A4.29,4.29,0,0,0,43,9.22l-2.41-.76A5.15,5.15,0,0,1,38,6.78a3.94,3.94,0,0,1-.83-2.41,3.7,3.7,0,0,1,.45-1.85,4.47,4.47,0,0,1,1.19-1.37A5.27,5.27,0,0,1,40.51.29,7.4,7.4,0,0,1,42.6,0a8.87,8.87,0,0,1,1.12.07q.57.07,1.08.19t.95.26a4.27,4.27,0,0,1,.7.29,1.59,1.59,0,0,1,.49.41.94.94,0,0,1,.15.55v.79q0,.52-.38.52a1.76,1.76,0,0,1-.64-.2,7.74,7.74,0,0,0-3.2-.64,4.37,4.37,0,0,0-2.21.47,1.6,1.6,0,0,0-.79,1.48,1.58,1.58,0,0,0,.49,1.18,4.94,4.94,0,0,0,1.83.92L44.55,7a5.08,5.08,0,0,1,2.57,1.6A3.76,3.76,0,0,1,47.9,11a4.21,4.21,0,0,1-.44,1.93,4.4,4.4,0,0,1-1.21,1.47,5.43,5.43,0,0,1-1.85.93A8.25,8.25,0,0,1,42.05,15.62Z"></path><path class="cls-2" d="M45.19,23.81C39.72,27.85,31.78,30,25,30A36.64,36.64,0,0,1,.22,20.57c-.51-.46-.06-1.09.56-.74A49.78,49.78,0,0,0,25.53,26.4,49.23,49.23,0,0,0,44.4,22.53C45.32,22.14,46.1,23.14,45.19,23.81Z"></path><path class="cls-2" d="M47.47,21.21c-.7-.9-4.63-.42-6.39-.21-.53.06-.62-.4-.14-.74,3.13-2.2,8.27-1.57,8.86-.83s-.16,5.89-3.09,8.35c-.45.38-.88.18-.68-.32C46.69,25.8,48.17,22.11,47.47,21.21Z"></path></svg>

</a>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/js/lunr.min.js?1768930323"></script>
<script type="text/javascript" src="/js/auto-complete.js?1768930323"></script>
<script type="text/javascript">
    
        var baseurl = "";
    
</script>
<script type="text/javascript" src="/js/search.js?1768930323"></script>

    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          




 
  
    
    <li data-nav-id="/1-workshop-instructions/" title="Workshop Instructions" class="dd-item 
        
        
        
        ">
      <a href="/1-workshop-instructions/">
           <b> 1. </b> Workshop Instructions
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/2-introduction-to-threat-detection-and-response-services/" title="Introduction to threat detection and response services " class="dd-item 
        
        
        
        ">
      <a href="/2-introduction-to-threat-detection-and-response-services/">
           <b> 2. </b> Introduction to threat detection and response services 
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/2-introduction-to-threat-detection-and-response-services/2.1-aws-security-hub/" title="AWS Security Hub" class="dd-item 
        
        
        
        ">
      <a href="/2-introduction-to-threat-detection-and-response-services/2.1-aws-security-hub/">
           <b> 2.1 </b> AWS Security Hub
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/2-introduction-to-threat-detection-and-response-services/2.1-aws-security-hub/2.1.1-security-hub-overview/" title="Security Hub - Overview" class="dd-item 
        
        
        
        ">
      <a href="/2-introduction-to-threat-detection-and-response-services/2.1-aws-security-hub/2.1.1-security-hub-overview/">
           <b> 2.1.1 </b> Security Hub - Overview
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2-introduction-to-threat-detection-and-response-services/2.1-aws-security-hub/2.1.2-security-hub-dashboard/" title="Security Hub - Dashboard" class="dd-item 
        
        
        
        ">
      <a href="/2-introduction-to-threat-detection-and-response-services/2.1-aws-security-hub/2.1.2-security-hub-dashboard/">
           <b> 2.1.2 </b> Security Hub - Dashboard
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2-introduction-to-threat-detection-and-response-services/2.1-aws-security-hub/2.1.3-security-hub-findings/" title="Security Hub - Findings" class="dd-item 
        
        
        
        ">
      <a href="/2-introduction-to-threat-detection-and-response-services/2.1-aws-security-hub/2.1.3-security-hub-findings/">
           <b> 2.1.3 </b> Security Hub - Findings
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2-introduction-to-threat-detection-and-response-services/2.1-aws-security-hub/2.1.4-security-hub-pricing/" title="Security Hub - Pricing" class="dd-item 
        
        
        
        ">
      <a href="/2-introduction-to-threat-detection-and-response-services/2.1-aws-security-hub/2.1.4-security-hub-pricing/">
           <b> 2.1.4 </b> Security Hub - Pricing
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2-introduction-to-threat-detection-and-response-services/2.1-aws-security-hub/2.1.5-security-hub-notifications/" title="Security Hub - Notifications" class="dd-item 
        
        
        
        ">
      <a href="/2-introduction-to-threat-detection-and-response-services/2.1-aws-security-hub/2.1.5-security-hub-notifications/">
           <b> 2.1.5 </b> Security Hub - Notifications
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2-introduction-to-threat-detection-and-response-services/2.2-amazon-guardduty/" title="Amazon GuardDuty" class="dd-item 
        
        
        
        ">
      <a href="/2-introduction-to-threat-detection-and-response-services/2.2-amazon-guardduty/">
           <b> 2.2 </b> Amazon GuardDuty
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/2-introduction-to-threat-detection-and-response-services/2.2-amazon-guardduty/2.2.1-guardduty-overview/" title="GuardDuty - Overview" class="dd-item 
        
        
        
        ">
      <a href="/2-introduction-to-threat-detection-and-response-services/2.2-amazon-guardduty/2.2.1-guardduty-overview/">
           <b> 2.2.1 </b> GuardDuty - Overview
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2-introduction-to-threat-detection-and-response-services/2.2-amazon-guardduty/2.2.2-guardduty-findings/" title="GuardDuty - Findings" class="dd-item 
        
        
        
        ">
      <a href="/2-introduction-to-threat-detection-and-response-services/2.2-amazon-guardduty/2.2.2-guardduty-findings/">
           <b> 2.2.2 </b> GuardDuty - Findings
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2-introduction-to-threat-detection-and-response-services/2.2-amazon-guardduty/2.2.3-guardduty-protection-plans/" title="GuardDuty - Protection plans" class="dd-item 
        
        
        
        ">
      <a href="/2-introduction-to-threat-detection-and-response-services/2.2-amazon-guardduty/2.2.3-guardduty-protection-plans/">
           <b> 2.2.3 </b> GuardDuty - Protection plans
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2-introduction-to-threat-detection-and-response-services/2.2-amazon-guardduty/2.2.4-guardduty-building-your-own-threat-list/" title="GuardDuty - Building your own threat list" class="dd-item 
        
        
        
        ">
      <a href="/2-introduction-to-threat-detection-and-response-services/2.2-amazon-guardduty/2.2.4-guardduty-building-your-own-threat-list/">
           <b> 2.2.4 </b> GuardDuty - Building your own threat list
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2-introduction-to-threat-detection-and-response-services/2.2-amazon-guardduty/2.2.5-guardduty-suppressing-findings/" title="GuardDuty - Suppressing findings" class="dd-item 
        
        
        
        ">
      <a href="/2-introduction-to-threat-detection-and-response-services/2.2-amazon-guardduty/2.2.5-guardduty-suppressing-findings/">
           <b> 2.2.5 </b> GuardDuty - Suppressing findings
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2-introduction-to-threat-detection-and-response-services/2.2-amazon-guardduty/2.2.6-guradduty-pricing/" title="GuardDuty - Pricing" class="dd-item 
        
        
        
        ">
      <a href="/2-introduction-to-threat-detection-and-response-services/2.2-amazon-guardduty/2.2.6-guradduty-pricing/">
           <b> 2.2.6 </b> GuardDuty - Pricing
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2-introduction-to-threat-detection-and-response-services/2.2-amazon-guardduty/2.2.7-guardduty-notifications/" title="GuardDuty - Notifications" class="dd-item 
        
        
        
        ">
      <a href="/2-introduction-to-threat-detection-and-response-services/2.2-amazon-guardduty/2.2.7-guardduty-notifications/">
           <b> 2.2.7 </b> GuardDuty - Notifications
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2-introduction-to-threat-detection-and-response-services/2.2-amazon-guardduty/2.2.8-guardduty-retaining-findings/" title="GuardDuty - Retaining findings" class="dd-item 
        
        
        
        ">
      <a href="/2-introduction-to-threat-detection-and-response-services/2.2-amazon-guardduty/2.2.8-guardduty-retaining-findings/">
           <b> 2.2.8 </b> GuardDuty - Retaining findings
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2-introduction-to-threat-detection-and-response-services/2.3-amazon-inspector/" title="Amazon Inspector" class="dd-item 
        
        
        
        ">
      <a href="/2-introduction-to-threat-detection-and-response-services/2.3-amazon-inspector/">
           <b> 2.3 </b> Amazon Inspector
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/2-introduction-to-threat-detection-and-response-services/2.3-amazon-inspector/2.3.1-inspector-overview/" title="Inspector - Overview" class="dd-item 
        
        
        
        ">
      <a href="/2-introduction-to-threat-detection-and-response-services/2.3-amazon-inspector/2.3.1-inspector-overview/">
           <b> 2.3.1 </b> Inspector - Overview
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2-introduction-to-threat-detection-and-response-services/2.3-amazon-inspector/2.3.2-inspector-dashboard/" title="Inspector - Dashboard" class="dd-item 
        
        
        
        ">
      <a href="/2-introduction-to-threat-detection-and-response-services/2.3-amazon-inspector/2.3.2-inspector-dashboard/">
           <b> 2.3.2 </b> Inspector - Dashboard
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2-introduction-to-threat-detection-and-response-services/2.3-amazon-inspector/2.3.3-inspector-findings/" title="Inspector  - Findings" class="dd-item 
        
        
        
        ">
      <a href="/2-introduction-to-threat-detection-and-response-services/2.3-amazon-inspector/2.3.3-inspector-findings/">
           <b> 2.3.3 </b> Inspector  - Findings
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2-introduction-to-threat-detection-and-response-services/2.3-amazon-inspector/2.3.4-inspector-vulnerability-database-search/" title="Inspector - Vulnerability database search" class="dd-item 
        
        
        
        ">
      <a href="/2-introduction-to-threat-detection-and-response-services/2.3-amazon-inspector/2.3.4-inspector-vulnerability-database-search/">
           <b> 2.3.4 </b> Inspector - Vulnerability database search
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2-introduction-to-threat-detection-and-response-services/2.3-amazon-inspector/2.3.5-inspector-suppressing-findings/" title="Inspector - Suppressing findings" class="dd-item 
        
        
        
        ">
      <a href="/2-introduction-to-threat-detection-and-response-services/2.3-amazon-inspector/2.3.5-inspector-suppressing-findings/">
           <b> 2.3.5 </b> Inspector - Suppressing findings
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2-introduction-to-threat-detection-and-response-services/2.3-amazon-inspector/2.3.6-inspector-pricing/" title="Inspector - Pricing" class="dd-item 
        
        
        
        ">
      <a href="/2-introduction-to-threat-detection-and-response-services/2.3-amazon-inspector/2.3.6-inspector-pricing/">
           <b> 2.3.6 </b> Inspector - Pricing
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2-introduction-to-threat-detection-and-response-services/2.4-amazon-detective/" title="Amazon Detective" class="dd-item 
        
        
        
        ">
      <a href="/2-introduction-to-threat-detection-and-response-services/2.4-amazon-detective/">
           <b> 2.4 </b> Amazon Detective
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/2-introduction-to-threat-detection-and-response-services/2.4-amazon-detective/2.4.1-detective-overview/" title="Detective - Overview" class="dd-item 
        
        
        
        ">
      <a href="/2-introduction-to-threat-detection-and-response-services/2.4-amazon-detective/2.4.1-detective-overview/">
           <b> 2.4.1 </b> Detective - Overview
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2-introduction-to-threat-detection-and-response-services/2.4-amazon-detective/2.4.2-detective-summary/" title="Detective - Summary" class="dd-item 
        
        
        
        ">
      <a href="/2-introduction-to-threat-detection-and-response-services/2.4-amazon-detective/2.4.2-detective-summary/">
           <b> 2.4.2 </b> Detective - Summary
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2-introduction-to-threat-detection-and-response-services/2.4-amazon-detective/2.4.3-detective-search/" title="Detective - Search" class="dd-item 
        
        
        
        ">
      <a href="/2-introduction-to-threat-detection-and-response-services/2.4-amazon-detective/2.4.3-detective-search/">
           <b> 2.4.3 </b> Detective - Search
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2-introduction-to-threat-detection-and-response-services/2.4-amazon-detective/2.4.4-detective-investigations/" title="Detective - Investigations" class="dd-item 
        
        
        
        ">
      <a href="/2-introduction-to-threat-detection-and-response-services/2.4-amazon-detective/2.4.4-detective-investigations/">
           <b> 2.4.4 </b> Detective - Investigations
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2-introduction-to-threat-detection-and-response-services/2.4-amazon-detective/2.4.5-detective-finding-groups/" title="Detective - Finding Groups" class="dd-item 
        
        
        
        ">
      <a href="/2-introduction-to-threat-detection-and-response-services/2.4-amazon-detective/2.4.5-detective-finding-groups/">
           <b> 2.4.5 </b> Detective - Finding Groups
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2-introduction-to-threat-detection-and-response-services/2.4-amazon-detective/2.4.6-detective-pricing/" title="Detective - Pricing" class="dd-item 
        
        
        
        ">
      <a href="/2-introduction-to-threat-detection-and-response-services/2.4-amazon-detective/2.4.6-detective-pricing/">
           <b> 2.4.6 </b> Detective - Pricing
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/2-introduction-to-threat-detection-and-response-services/2.4-amazon-detective/2.4.7-detective-eks-audit-logs/" title="Detective - EKS Audit Logs" class="dd-item 
        
        
        
        ">
      <a href="/2-introduction-to-threat-detection-and-response-services/2.4-amazon-detective/2.4.7-detective-eks-audit-logs/">
           <b> 2.4.7 </b> Detective - EKS Audit Logs
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/3/" title="Integrating AWS Services and Partner Solutions" class="dd-item 
        parent
        
        
        ">
      <a href="/3/">
           <b> 3. </b> Integrating AWS Services and Partner Solutions
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/3/3.1/" title="Centralizing findings from AWS security services" class="dd-item 
        
        
        
        ">
      <a href="/3/3.1/">
           <b> 3.1. </b> Centralizing findings from AWS security services
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/3/3.2/" title="Aggregating findings from multiple AWS accounts" class="dd-item 
        
        
        
        ">
      <a href="/3/3.2/">
           <b> 3.2. </b> Aggregating findings from multiple AWS accounts
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/3/3.3/" title="Centralizing findings from AWS partner solutions" class="dd-item 
        
        
        
        ">
      <a href="/3/3.3/">
           <b> 3.3. </b> Centralizing findings from AWS partner solutions
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/3/3.4/" title="Cross-region finding aggregation" class="dd-item 
        
        
        
        ">
      <a href="/3/3.4/">
           <b> 3.4. </b> Cross-region finding aggregation
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/3/3.5/" title="Building your own Security Hub integration" class="dd-item 
        parent
        active
        
        ">
      <a href="/3/3.5/">
           <b> 3.5. </b> Building your own Security Hub integration
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
         
    </ul>

    
    
      <section id="shortcuts">
        <h3>More</h3>
        <ul>
          
              <li> 
                  <a class="padding" href="https://www.facebook.com/groups/awsstudygroupfcj/"><i class='fab fa-facebook'></i> AWS Study Group</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="prefooter">
      <hr/>
      <ul>
      
        <li>
          <a class="padding">
            <i class="fas fa-language fa-fw"></i>
          <div class="select-style">
            <select id="select-language" onchange="location = this.value;">
          
          
          
              
              
                  
                    
                    
                      <option id="en" value="/3/3.5/" selected>English</option>
                    
                  
              
                  
              
          
              
              
                  
              
                  
                    
                    
                      <option id="vi" value="/vi/3/3.5/">Tiếng Việt</option>
                    
                  
              
          
        </select>
        <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
          width="255px" height="255px" viewBox="0 0 255 255" style="enable-background:new 0 0 255 255;" xml:space="preserve">
          <g>
            <g id="arrow-drop-down">
              <polygon points="0,63.75 127.5,191.25 255,63.75 		" />
            </g>
          </g>
        </svg>
        </div>
        </a>
        </li>
      
      
      
        <li><a class="padding" href="#" data-clear-history-toggle=""><i class="fas fa-history fa-fw"></i> Clear History</a></li>
      
      </ul>
    </section>
    
    <section id="footer">
      <left>
    
     <b> Workshop</b> <br>
    <img src="https://hitwebcounter.com/counter/counter.php?page=7920860&style=0038&nbdigits=9&type=page&initCount=0" title="Migrate" Alt="web counter"   border="0" /></a>  <br>
     <b> <a href="https://cloudjourney.awsstudygroup.com/">Cloud Journey</a></b> <br>
    <img src="https://hitwebcounter.com/counter/counter.php?page=7830807&style=0038&nbdigits=9&type=page&initCount=0" title="Total CLoud Journey" Alt="web counter"   border="0"   />
     
</left>
<left>
    <br>
    <br>
        <b> Last Updated </b> <br>
        <i><font color=orange>23/10</font></i>
    </left>
    <left>
        <br>
        <br>
            <b> Author </b> <br>
           
            <i><a href="https://www.linkedin.com/in/anhpnh"  style="color:orange">Duc Toan, Khanh Quoc </a> <br>
                
               
        </i>
        </left>

<script async defer src="https://buttons.github.io/buttons.js"></script>

    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            <a href='/'>Threat Detection & Response Workshop</a> > <a href='/3/'>Integrating AWS Services and Partner Solutions</a> > Building your own Security Hub integration
          
        
          
        
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              Building your own Security Hub integration
            </h1>
          

        



	<p>In this module, you will build a custom solution to send findings from Security Hub to a Slack channel. To accomplish this, you will set up a custom action that will send the details of a Security Hub Finding to a Lambda function (via EventBridge) that will format the message and then post into a Slack security alerts channel. Once the setup is complete, findings will flow from left to right in the below diagram.</p>
<h4 id="setup-slack-workspace">Setup Slack workspace</h4>
<ol>
<li>For the purposes of this workshop, we recommend setting up a new temporary Slack workspace. Use the following link to create a new Slack workspace: <a href="https://get.slack.help/hc/en-us/articles/206845317-Create-a-Slack-workspace">https://get.slack.help/hc/en-us/articles/206845317-Create-a-Slack-workspace</a></li>
</ol>
<p><img src="/images/3/3.5/s1.png" alt="VPC"></p>
<p><img src="/images/3/3.5/s1a.png" alt="VPC">
2. When you have finished creating your Slack workspace, create a new channel named &ldquo;security-hub-alerts&rdquo;. This is where we will send notifications from Security Hub using the custom integration. For this exmaple, set the channel visibility to public.
<img src="/images/3/3.5/s2a.png" alt="VPC">
<img src="/images/3/3.5/s2b.png" alt="VPC"></p>
<h4 id="setup-slack-application-for-integration">Setup Slack application for integration</h4>
<ol start="3">
<li>Go to the Slack API site, <a href="https://api.slack.com">https://api.slack.com</a>.</li>
</ol>
<p><img src="/images/3/3.5/s3.png" alt="VPC">
4. At the top of the page, click Your apps. Then click Create an App.</p>
<p><img src="/images/3/3.5/s4.png" alt="VPC">
5. In the Create an app popup. choose From scratch.</p>
<p><img src="/images/3/3.5/s5.png" alt="VPC"></p>
<ol start="6">
<li>
<p>For App Name input &ldquo;security-hub-to-slack&rdquo;. For Pick a workspace to develop your app in select the workspace you just created.</p>
</li>
<li>
<p>Click <strong>Create App</strong>.
<img src="/images/3/3.5/s7.png" alt="VPC"></p>
</li>
<li>
<p>Open <strong>Incoming Webhooks</strong>.
<img src="/images/3/3.5/s8.png" alt="VPC"></p>
</li>
<li>
<p>On the <strong>Activate Incoming Webhooks</strong> page, switch the toggle to ON.</p>
</li>
<li>
<p>Then at the bottom of the page, click <strong>Add New Webhook to Workspace</strong>.
<img src="/images/3/3.5/s10.png" alt="VPC"></p>
</li>
<li>
<p>On the page that asks, &ldquo;Where should security-hub-alerts post?&rdquo; Select <strong>#security-hub-alerts</strong>. Click <strong>Allow</strong>.</p>
</li>
<li>
<p>Back on the Incoming Webhooks page, copy the <strong>Webhook URL</strong> you just created. You will need this later.</p>
</li>
</ol>
<p><img src="/images/3/3.5/s12.png" alt="VPC"></p>
<h4 id="create-custom-action-in-security-hub">Create Custom Action in Security Hub</h4>
<p>Slack is setup. Now you need to configure the Security Hub custom action, EventBridge rule, and Lambda function to push findings to your Slack app (via the webhook).</p>
<ol start="13">
<li>
<p>Return to Security Hub. <a href="https://console.aws.amazon.com/securityhub/">https://console.aws.amazon.com/securityhub/</a></p>
</li>
<li>
<p>Open the Custom actions page from the navigation on the left under Management.</p>
</li>
<li>
<p>Click Create custom action.</p>
</li>
</ol>
<p><img src="/images/3/3.5/s15.png" alt="VPC">
16. For Action name input &ldquo;Send to Slack&rdquo;. For Description input &ldquo;Custom action to send findings to Slack.&rdquo; For Custom action ID input &ldquo;SendToSlack&rdquo;.</p>
<ol start="17">
<li>Copy the Custom action ARN that was generated for Send to Slack. You will need this later.</li>
</ol>
<h4 id="create-the-eventbridge-rule">Create the EventBridge Rule</h4>
<p><img src="/images/3/3.5/s17.png" alt="VPC">
Result:
<img src="/images/3/3.5/s17b.png" alt="VPC">
18. Navigate to <strong>Amazon EventBridge</strong>.</p>
<ol start="19">
<li>
<p>Click on the <strong>Create rule</strong> on the right side.</p>
</li>
<li>
<p>In the <strong>Define rule detail</strong> page give your rule a <strong>name</strong> and a <strong>description</strong> that represents the rule&rsquo;s purpose (for example, the same name and description you used for the custom action). Then click <strong>Next</strong>.</p>
</li>
<li>
<p>All Security Hub findings are sent as events to the AWS default event bus. The define pattern section allows you to identify filters to take a specific action when matched events appear. On the <strong>Build event pattern</strong> step, leave the <strong>Event source</strong> set to <strong>AWS events or EventBridge partner events</strong>.</p>
</li>
<li>
<p>Scroll down to Event pattern. Under Event source, leave it set to AWS Services, and under AWS Service, select Security Hub.</p>
</li>
<li>
<p>For the Event Type, choose Security Hub Findings – Custom Action.</p>
</li>
<li>
<p>Then select the Specific custom action ARN(s) radio button and enter the ARN for the custom action that you just created.</p>
</li>
<li>
<p>Click Next.</p>
</li>
</ol>
<p><img src="/images/3/3.5/s25.png" alt="VPC"></p>
<ol start="26">
<li>On the Select target(s) step, select Lambda function from the Select a target dropdown. Then select security-hub-to-slack from the Function dropdown.</li>
</ol>
<p><img src="/images/3/3.5/s26.png" alt="VPC"></p>
<ol start="27">
<li>The Lambda function, security-hub-to-slack, was created using CloudFormation before the start of the lab. If you want to review the code, you can see it in the Lambda console. Click Next.</li>
</ol>
<p><img src="/images/3/3.5/s27.png" alt="VPC">
28. On the Configure tags step, click Next.</p>
<p><img src="/images/3/3.5/s28.png" alt="VPC"></p>
<ol start="29">
<li>On the Review and create step, click Create rule.</li>
</ol>
<h4 id="customize-the-lambda-function-to-send-messages-to-your-slack-channel">Customize the Lambda function to send messages to your Slack channel</h4>
<ol start="30">
<li>Navigate to the Lambda console and open the Functions page.</li>
</ol>
<p><img src="/images/3/3.5/s30.png" alt="VPC"></p>
<ol start="31">
<li>
<p>Open the security-hub-to-slack function by clicking on the name.</p>
</li>
<li>
<p>On the function page, open the Configuration tab and then choose Environment variables.</p>
</li>
</ol>
<p><img src="/images/3/3.5/s32.png" alt="VPC"></p>
<ol start="33">
<li>Click the <strong>Edit</strong> button. Set slackChannel to &ldquo;security-hub-alerts&rdquo;. Set webHookUrl to the webhook you copied earlier in this module.</li>
</ol>
<p><img src="/images/3/3.5/s33.png" alt="VPC"></p>
<ol start="34">
<li>Click Save.</li>
</ol>
<h4 id="test-the-integration">Test the Integration</h4>
<p>At this point, everything is setup. Test the integration!</p>
<ol start="35">
<li>
<p>Go to Security Hub, and open the Findings page. <a href="https://console.aws.amazon.com/securityhub">https://console.aws.amazon.com/securityhub</a></p>
</li>
<li>
<p>Check the box next to one finding.</p>
</li>
</ol>
<p><img src="/images/3/3.5/s36.png" alt="VPC"></p>
<ol start="37">
<li>Under the Actions dropdown, choose Send to Slack.</li>
</ol>
<p><img src="/images/3/3.5/s37.png" alt="VPC">
Result:
<img src="/images/3/3.5/s37b.png" alt="VPC"></p>
<ol start="38">
<li>Return to Slack and open the channel you created, #security-hub-alerts. You should see a new message.</li>
</ol>
<p>See that “security-hub-alerts” channel has news</p>
<p><img src="/images/3/3.5/s38.png" alt="VPC">
Click on that channel to view:
<img src="/images/3/3.5/s38b.png" alt="VPC"></p>
<h4 id="automate-the-slack-messages">Automate the slack messages</h4>
<p><strong>Problem Statement</strong>:
Your manager is concerned about the scalability of the appraoch you implemented because it requires you to manually select the findings to be sent to Slack. You have been instructed to automate this so findings that have MEDIUM or HIGH severity labels are automatically sent to Slack via the integration.
Can you figure out what changes need to be made in order to accomplish this objective?</p>
<p><strong>Hint</strong>: <br>
6. Select <strong>Specific Severity label(s)</strong> and in the dropdown, pick <strong>MEDIUM</strong> and <strong>HIGH</strong>. That&rsquo;s it. Continue through the same steps as before
<img src="/images/3/3.5/h6.png" alt="VPC"></p>
<ol start="7">
<li>
<p>Click <strong>Next</strong>.</p>
</li>
<li>
<p>On the Select target(s) step, select Lambda function from the Select a target dropdown. Then select security-hub-to-slack from the Function dropdown. Click Next.</p>
</li>
</ol>
<p><img src="/images/3/3.5/h6-s8.png" alt="VPC"></p>
<ol start="9">
<li>
<p>On the Configure tags step, click Next.</p>
</li>
<li>
<p>On the Review and create step, click Create rule.
<img src="/images/3/3.5/h6-s10a.png" alt="VPC">
<img src="/images/3/3.5/h6-s10b.png" alt="VPC"></p>
</li>
</ol>





<footer class=" footline" >
	
</footer>

        
        </div> 
        

      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
        
        


	 
	 
		
			<a class="nav nav-prev" href="/3/3.4/" title="Cross-region finding aggregation"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="/3/3.1/" title="Centralizing findings from AWS security services" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/clipboard.min.js?1768930323"></script>
    <script src="/js/perfect-scrollbar.min.js?1768930323"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js?1768930323"></script>
    <script src="/js/jquery.sticky.js?1768930323"></script>
    <script src="/js/featherlight.min.js?1768930323"></script>
    <script src="/js/highlight.pack.js?1768930323"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/modernizr.custom-3.6.0.js?1768930323"></script>
    <script src="/js/learn.js?1768930323"></script>
    <script src="/js/hugo-learn.js?1768930323"></script>

    <link href="/mermaid/mermaid.css?1768930323" rel="stylesheet" />
    <script src="/mermaid/mermaid.js?1768930323"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-158079754-2', 'auto');
  ga('send', 'pageview');

</script>
  </body>
</html>
